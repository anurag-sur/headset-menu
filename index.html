<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VR Food Menu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- A-Frame -->
<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>

<script>
// ===== FOOD DATA =====
const foods = [
  { model:"burger/scene.gltf", name:"Burger", price:"₹149", scale:0.4 },
  { model:"pizza/scene.gltf",  name:"Pizza",  price:"₹299", scale:2.0 },
  { model:"fries/scene.gltf",  name:"Fries",  price:"₹99",  scale:0.5 },
  { model:"samosa/scene.gltf", name:"Samosa", price:"₹25",  scale:0.6 }
];

let index = 0;

// ===== UPDATE MODEL + TEXT =====
function updateFood() {
  const food = foods[index];
  const model = document.querySelector("#mainModel");
  const label = document.querySelector("#foodLabel");

  model.setAttribute("gltf-model", food.model);
  model.setAttribute("scale", `${food.scale} ${food.scale} ${food.scale}`);
  label.setAttribute("value", `${food.name} • ${food.price}`);
}

// ===== ARROW BUTTON COMPONENT =====
AFRAME.registerComponent("arrow", {
  schema: { dir: { type: "string" } },

  init() {
    const cursor = document.querySelector("#cursor");

    this.el.addEventListener("mouseenter", () => {
      cursor.setAttribute("material", "color", "#00ffd5");
    });

    this.el.addEventListener("mouseleave", () => {
      cursor.setAttribute("material", "color", "white");
    });

    this.el.addEventListener("click", () => {
      if (this.data.dir === "left") {
        index = (index - 1 + foods.length) % foods.length;
      } else {
        index = (index + 1) % foods.length;
      }
      updateFood();
    });
  }
});

// ✅ VERY IMPORTANT: load first food properly
window.addEventListener("load", updateFood);
</script>
</head>

<body style="margin:0; overflow:hidden;">

<a-scene background="color:#0b0b0b" vr-mode-ui="enabled:true">

  <!-- CAMERA + CURSOR -->
  <a-entity camera look-controls position="0 1.6 0">
    <a-cursor
      id="cursor"
      raycaster="objects: .clickable"
      fuse="true"
      fuse-timeout="600"
      geometry="primitive:ring; radiusInner:0.015; radiusOuter:0.025"
      material="color:white; shader:flat">
    </a-cursor>
  </a-entity>

  <!-- LIGHTS -->
  <a-light type="ambient" intensity="0.7"></a-light>
  <a-light type="directional" position="2 5 3" intensity="1"></a-light>

  <!-- MAIN MODEL (NO HARD-CODED FOOD) -->
  <a-entity
    id="mainModel"
    position="0 1.2 -3"
    animation="property: rotation; to: 0 360 0; loop:true; dur:14000">
  </a-entity>

  <!-- FOOD LABEL -->
  <a-text
    id="foodLabel"
    position="0 2.6 -3.2"
    align="center"
    color="white"
    width="4">
  </a-text>

  <!-- LEFT ARROW -->
  <a-entity
    class="clickable"
    arrow="dir: left"
    position="-1.6 1.2 -2"
    geometry="primitive: triangle"
    material="color:white; side:double"
    rotation="0 0 180">
  </a-entity>

  <!-- RIGHT ARROW -->
  <a-entity
    class="clickable"
    arrow="dir: right"
    position="1.6 1.2 -2"
    geometry="primitive: triangle"
    material="color:white; side:double">
  </a-entity>

  <a-sky color="#111"></a-sky>

</a-scene>

</body>
</html>
